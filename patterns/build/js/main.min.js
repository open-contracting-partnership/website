function lower(e){return e.toLowerCase()}function upper(e){return e.substr(0,1).toUpperCase()+e.substr(1)}var makeFriendlyName=function(e){return e.replace(/-/g," ")},small="(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|v[.]?|via|vs[.]?)",punct="([!\"#$%&'()*+,./:;<=>?@[\\\\\\]^_`{|}~-]*)";this.titleCaps=function(e){for(var t=[],n=/[:.;?!] |(?: |^)["Ò]/g,a=0;;){var r=n.exec(e);if(t.push(e.substring(a,r?r.index:e.length).replace(/\b([A-Za-z][a-z.'Õ]*)\b/g,function(e){return/[A-Za-z]\.[A-Za-z]/.test(e)?e:upper(e)}).replace(RegExp("\\b"+small+"\\b","ig"),lower).replace(RegExp("^"+punct+small+"\\b","ig"),function(e,t,n){return t+upper(n)}).replace(RegExp("\\b"+small+punct+"$","ig"),upper)),a=n.lastIndex,!r)break;t.push(r[0])}return t.join("").replace(/ V(s?)\. /gi," v$1. ").replace(/(['Õ])S\b/gi,"$1s").replace(/\b(AT&T|Q&A)\b/gi,function(e){return e.toUpperCase()})};var doTree=function(e){var t=[];return $.each(e,function(e,n){var a="string"!=typeof n,r={name:e.replace(".html",""),order:9999};null!==r.name.match("^[0-9]+[.]")&&(r.order=parseInt(r.name.split(".")[0]),r.name=r.name.substring(r.name.indexOf(".")+1)),a&&(r.children=doTree(n)),a||(r.path=n,$.get("/styleguide/templates/"+n).done(function(e){r.html=e})),r.name=titleCaps(makeFriendlyName(r.name)),t.push(r)}),t.sort(function(e,t){return e.order-t.order}),t},flattenTree=function(e){var t=[];return"undefined"!=typeof e.items&&$.each(e.items,function(e,n){"undefined"!=typeof n.filepath&&t.push(n),"undefined"!=typeof n.items&&Array.prototype.push.apply(t,flattenTree(n))}),t},parseComponent=function(e){var t=JSON.parse(e.contents),n="";return"colours"===t.type&&t.colours.forEach(function(e){n+='<div class="sg-colour"><div class="sg-colour__sample" style="background-color: '+e.hex+';"></div><p>'+e.label+"</p><p>"+e.hex.toUpperCase()+"</p></div>"}),e.contents=n,e},parseComponents=function(e){return $.each(e.items,function(e,t){"undefined"!=typeof t.items?parseComponents(t):(t.isComponent=null!==t.filepath.match(".json$"),t.filepath.match(".json$")&&(t=parseComponent(t)))}),e};Vue.component("tree",{template:"#item-template",props:{model:Object},methods:{hasChildren:function(e){return"undefined"!=typeof e.items}}}),Vue.component("pattern",{template:"#pattern-template",props:{model:Array},methods:{hasChildren:function(e){return"undefined"!=typeof e.items}}});var css=null,demo=new Vue({el:"body",ready:function(){this.fetchData()},data:{treeData:{items:{}},search:""},computed:{flatTreeData:function(){return flattenTree(this.treeData)}},watch:{treeData:{handler:function(){this.applyCSS()},deep:!0}},methods:{filterPatterns:function(){this.treeData=this.setFilter(this.treeData,this.search)},setFilter:function(e,t){var n=new RegExp(t,"gi");return $.each(e.items,function(a,r){var s=!1;e.items[a].display=!0,null===e.items[a].name.match(n)&&(e.items[a].display=!1),"undefined"!=typeof e.items[a].items&&(e.items[a]=this.setFilter(e.items[a],t),$.each(e.items[a].items,function(e,t){t.display===!0&&(s=!0)})),s===!0&&(e.items[a].display=!0)}.bind(this)),e},getCSS:function(){css="",$.get(css_url,function(e){css=e,this.applyCSS()}.bind(this))},applyCSS:function(){if(null!==css){$("style[scoped]").html(css);var e=document.createEvent("Event");e.initEvent("DOMContentLoaded",!0,!0),window.document.dispatchEvent(e)}else this.getCSS()},fetchData:function(){$.getJSON("./paths.json").done(function(e){e=parseComponents(e),demo.treeData=e,demo.flatTreeData=flattenTree(e),this.$nextTick(function(){this.applyCSS()})}.bind(this))}}});